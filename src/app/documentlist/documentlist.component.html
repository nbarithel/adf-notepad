<div class="app-docsAndViewer">

    <div class="app-doc-list">
      <adf-upload-drag-area
        acceptedFilesType=".rtf,.txt,.xml,.html"
        (success)="success($event,'uploaded')">

        <adf-toolbar>
            <adf-toolbar-title>
              <adf-breadcrumb
                [target]="documentList"
                [folderNode]="documentList.folderNode">
              </adf-breadcrumb>
            </adf-toolbar-title>
            <adf-search-control [highlight]="true" (searchChange)="getSearchTerm($event)">
            </adf-search-control>
        </adf-toolbar>

        <adf-document-list
          #documentList
          [currentFolderId]="myStartFolder"
          [contentActions]="true"
          [rowFilter]="fileFilter"
          [allowDropFiles]="true"
          (nodeClick)= "getNodeId($event)"
          (ready)="ready()">

          <data-columns>
              <data-column key="icon" type="image" [sortable]="false"></data-column>
              <data-column key="name" title="Name"></data-column>
              <data-column
                class="full-width name-column"
                title="Tag"
                key="id"
                [sortable]="false"
                class="full-width ellipsis-cell">
                <ng-template let-entry="$implicit">
                    <adf-tag-node-list  [nodeId]="entry.data.getValue(entry.row, entry.col)"></adf-tag-node-list>
                </ng-template>
              </data-column>
              <data-column key="createdAt" title="Created on" type="date" format="medium"></data-column>
              <data-column key="createdByUser.displayName" title="Created By"></data-column>

     <!--        <data-column key="ui" title="Annexes">
                <ng-template let-entry="$implicit">
                    <span>0</span>
                </ng-template>
            </data-column> -->

          </data-columns>

          <content-actions>

            <content-action
              icon="get_app"
              title="{{'DOCUMENT.CONTENT_ACTION.DOWNLOAD'}}"
              handler="download">
            </content-action>

            <content-action
              icon="gesture"
              title="{{'DOCUMENT.CONTENT_ACTION.RENAME'}}"
              permission="update"
              (execute)="rename($event)">
            </content-action>

            <content-action
              icon="content_copy"
              title="{{'NODE_SELECTOR.COPY'}}"
              permission="update"
              handler="copy"
              (execute)="success($event,'Copied')">
            </content-action>

            <content-action
              icon="subdirectory_arrow_left"
              title="{{'NODE_SELECTOR.MOVE'}}"
              permission="update"
              handler="move"
              (execute)="success($event,'Moved')">
            </content-action>

            <content-action
              icon="delete"
              title="{{'ADF_VERSION_LIST.ACTIONS.DELETE'}}"
              permission="update"
              (execute)="success($event,'Deleted')">
            </content-action>

          </content-actions>

        </adf-document-list>

        <adf-pagination
          [target]="documentList"
          *ngIf="notesNumber != 0">
        </adf-pagination>
      </adf-upload-drag-area>
    </div>

    <adf-toolbar-divider class="adf-toolbar-divider-doclist"></adf-toolbar-divider>

    <app-info-drawer (selectedIndexChange)="showTabs($event)" *ngIf="nodeId && !createNote">

      <app-info-drawer-tab icon="notes" label="Note">
          <div info-drawer-content id="info-drawer-content-editor">
            <app-text-editor [node]="node" (success)="success($event,'enregistrée')"></app-text-editor>
          </div>
      </app-info-drawer-tab>

      <app-info-drawer-tab icon="description" label="{{'METADATA.BASIC.HEADER' | translate}}">
        <adf-content-metadata-card [node]="node"></adf-content-metadata-card>
        <app-notepad-social [nodeId]="nodeId">
        </app-notepad-social>
      </app-info-drawer-tab>

      <app-info-drawer-tab icon="ballot" label="Versions">
        <mat-card>
          <mat-card-content>
            <adf-version-list [node]="node">
            </adf-version-list>
          </mat-card-content>
        </mat-card>
      </app-info-drawer-tab>

      <app-info-drawer-tab icon="link" label="{{'DOCUMENT.CONTENT_VIEW.LINKDOC' | translate}}">
        <mat-card>
          <mat-card-content>
            <app-appendix [nodeId]="nodeId"></app-appendix>
          </mat-card-content>
        </mat-card>
      </app-info-drawer-tab>

      <app-info-drawer-tab icon="comment" label="{{'DOCUMENT.CONTENT_VIEW.COMMENTS' | translate}}" badge="{{ commentsNumber }}">
          <mat-card>
            <app-comments (commentsNumber)="getCommentsNumber($event)" [nodeId]="nodeId"></app-comments>
            <app-tag [nodeId]="nodeId"></app-tag>
          </mat-card>
      </app-info-drawer-tab>

    </app-info-drawer>

    <adf-info-drawer-layout *ngIf="!nodeId && !createNote">
      <div info-drawer-content  class="empty-align">
        <adf-empty-content
          icon="waves"
          title="{{'DOCUMENT.EMPTY_CONTENT.TITLE' | translate}}"
          [subtitle]="translatedText">
        </adf-empty-content>
        <button class="createNote-button" mat-button (click)="createNotes()">
          <mat-icon>create</mat-icon>
          {{'SIDENAV.MENU.NOTE' | translate}}
        </button>
      </div>
    </adf-info-drawer-layout>


    <adf-info-drawer-layout *ngIf="createNote && !nodeId">
      <div info-drawer-title>Edition de note</div>
      <div info-drawer-content id="info-drawer-content-editor">
        <app-text-editor (success)="success($event,'enregistrée')"></app-text-editor>
      </div>
    </adf-info-drawer-layout>

  </div>

  <adf-file-uploading-dialog></adf-file-uploading-dialog>
